\RequirePackage{luatex85}

\documentclass[preprint,prb,amsmath,superscriptaddress,showpacs]{revtex4}

%\usepackage[utf8]{inputenc}
% utf8 is not necessary once we use luatex engine

\usepackage{graphics}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn} % Align table columns on decimal point
\usepackage{bm}
\usepackage{epsfig}
\usepackage{physics}
\usepackage[linktoc=all]{hyperref}
\usepackage{natbib}
\usepackage{bibentry}
\usepackage{ bbold }
\usepackage{pgf,tikz}
\usepackage[compat=1.1.0]{tikz-feynman}
\usepackage{contour}

\newcommand{\bk}{\mathbf{k}}
\newcommand{\bq}{\mathbf{q}}


\begin{document}
\title{RPA susceptibility}

\author{Diana Csontosová}
%\email{kunes@ifp.tuwien.ac.at}
%\affiliation{TU Wien}

%\pacs{71.70.Ej,71.27.+a,75.40.Gb}
\date{\today}

%\maketitle

\section{Derivation}


The dynamic susceptibility is given by the lattice Bethe Salpeter equation
\begin{equation*}
  \begin{split}
    \chi(q)_{\nu\nu'}^{-1} &= \chi^{0 \, -1}(q)_{\nu\nu'} - \Gamma_{\bar{\nu}\bar{\nu}'}
  \end{split}
\end{equation*}

Therefore, the dynamic susceptibility $\chi(\bq, \omega)$ can be calculated on the real
frequency as soon as the quantities in the BSE above, i.e. the lattice bubble and the
irreducible vertex, summed over fermionic frequencies, are also known
on the real frequency axis. In the RPA regime, the irreducible vertex
is a constant in frequency, it is therefore assumed to be known. The
expression for the lattice bubble on the real frequency axis may be
obtained analytically as follows.

The Lehmann representation of the
Green's function reads
% 
\begin{equation}
  \mathfrak{G}(\mathbf{k}, i\nu_n) =
  \int \mathrm{d}E^{\prime}
  \frac{A(\mathbf{k}, E^{\prime})}{i\nu_n - E^{\prime}}.
\end{equation}
%
This expression is inserted in the definition for the lattice bubble
expressed on the Matsubara axis\cite{Boehnke2011, Kunes2011}:
%
\begin{equation}
  \begin{aligned}
      \chi^0(\bq, i\nu_n, i\nu_{n'}, i \omega_m) &=
      - \sum_{\bk}
      \mathfrak{G}(\bk, i\nu_n)
      \mathfrak{G}(\bk + \bq, i\nu_{n'} + i\omega_m) \delta_{n n'} \\
      &= - \iint
      \mathrm{d}E'
      \mathrm{d}E''
      A(\bk, E') 
      A(\bk + \bq, E'')
      \dfrac{1}{i\nu_n - E'}
      \dfrac{1}{i\nu_{n} + i \omega_m - E''}\delta_{n n'}.
    \end{aligned}
  \end{equation}
  %
Once we sum over fermionic frequencies, this becomes 
%
\begin{equation}
  \begin{aligned}
    \chi^0(\bq, i \omega_m) &=
    - \sum_{\bk, \, i\nu_n}
    \mathfrak{G}(\bk, i\nu_n)
    \mathfrak{G}(\bk + \bq, i\nu_{n} + i\omega_m) \\
    &= - \iint
    \mathrm{d}E'
    \mathrm{d}E''
    \sum_{\bk} A(\bk, E') 
      A(\bk + \bq, E'')
      \sum_{i\nu_n}
    \dfrac{1}{i\nu_n - E'}
    \dfrac{1}{i\nu_{n} + i \omega_m - E''}.
    \end{aligned}
\end{equation}
%
The sum $\sum_{i\nu_n} \dfrac{1}{i\nu_n - E'} \dfrac{1}{i\nu_{n} + i
  \omega_m - E''}$ is a standard Matsubara frequency summation, whose
expression can be found in the literature (e.g. Ref~\onlinecite{Mahan},
eq. 3.5.2):
\begin{equation}
  \begin{aligned}
    \label{eq:continuation}
    \dfrac{1}{\beta} &
    \sum_{i\nu_n}
    \dfrac{1}{i\nu_n - E'}
    \dfrac{1}{i\nu_{n} + i \omega_m - E''} =
    \dfrac{n_F(E') - n_F(E'')}
    {i\omega_m + E' - E''} \\
    \chi^0(\bq, i \omega_m)
    &= - \beta
    \iint
    \mathrm{d}E'
    \mathrm{d}E''
    \sum_{\bk} A(\bk, E') 
    A(\bk + \bq, E'')
    \dfrac{n_F(E') - n_F(E'')}
    {i\omega_m + E' - E''} \\
    \chi^0(\bq, \omega)
    &= - \beta
    \iint
    \mathrm{d}E'
    \mathrm{d}E''
    \sum_{\bk} A(\bk, E') 
    A(\bk + \bq, E'')
    \dfrac{n_F(E') - n_F(E'')}
    {\omega + E' - E'' + i\delta} \\
    \end{aligned}
\end{equation}
where the analytical continuation is performed in the last step via the
substitution $i\omega_m \rightarrow \omega + i\delta$, with $\delta$
infinitesimal. The imaginary and real parts of the last expression in
Eq.~\ref{eq:continuation} can be obtained using
%To extract imaginary part of term in bracket we use Sokhotski–Plemelj
%theorem
%
\begin{equation}
  \lim_{\epsilon \rightarrow 0^{+}} \frac{1}{x \pm i\epsilon} = \mp
  i\pi\delta (x) + \mathcal{P}\left( \frac{1}{x} \right):
\end{equation}
%
%Applying the theorem we get
\begin{equation}
  \begin{aligned}
    \Im \chi^0(\bq, \omega)
    &= \pi \beta
    \int
    \mathrm{d} E'
    \sum_{\bk} A(\bk, E') 
    A(\bk + \bq, E' + \omega)
    \qty[n_F(E') - n_F(E' + \omega) ].
    \end{aligned}
\end{equation}
This convolution in frequency and wavevector may be computed
efficiently using FFT. The Kramers-Kronig relations allows us
to obtain the real part of the bubble on the real frequency axis:
%
\begin{equation}
  \Re \chi^0(\bq, \omega) =
  \dfrac{1}{\pi} \mathcal{P}
  \int_{-\infty}^{\infty}
  \mathrm{d} \omega' \frac{\Im \chi^0(\bq, \omega)}{\omega' - \omega}.
\end{equation}
%

\newpage

Now, we focus on terms in Eq.~\eqref{eq:final_susc}
%
\begin{align*}
I_1 =& \sum_{\mathbf{k}} \int  \mathrm{d}E A(\mathbf{k} +
       \mathbf{q}, E + \omega) A(\mathbf{k}, E) n_F(E), \\
I_2 =& \sum_{\mathbf{k}} \int  \mathrm{d}E A(\mathbf{k} +
       \mathbf{q}, E + \omega) A(\mathbf{k}, E) n_F(E+\omega),
\end{align*}
%
where we identify convolution when we mark $H(\mathbf{k}, E) =
A(\mathbf{k}, E) n_F(E)$ in $I_1$ and $H(\mathbf{k}+\mathbf{q}, E+\omega) =
A(\mathbf{k} + \mathbf{q}, E + \omega) n_F(E+\omega)$ in $I_2$, thus
%
\begin{align*}
I_1 =& \sum_{\mathbf{k}} \int  \mathrm{d}E A(\mathbf{k} +
       \mathbf{q}, E + \omega) H(\mathbf{k}, E), \\
I_2 =& \sum_{\mathbf{k}} \int  \mathrm{d}E H(\mathbf{k} +
       \mathbf{q}, E + \omega) A(\mathbf{k}, E).
\end{align*}
%
Due to the convolution theorem, we obtain the values of integrals as
%
\begin{equation}
I = \{ A * H \}(\omega) = \mathcal{F}^{-1} \{ A^{\mathrm{FT}}
\dotproduct H^{\mathrm{FT}} \}.
\end{equation}
%
$\mathcal{F}^{-1}$ denotes inverse Fourier transform. Hence, instead of direct
calculation of convolution, we use FFT and IFFT algorithms in the
code.

Using RPA approximation we can further write spectral function
$A(\mathbf{k}, E)$ as
%
\begin{equation}
A(\mathbf{k}, E) = - \frac{1}{\pi} \mathrm{Im} (G_{\mathrm{ret}}(\mathbf{k}, E)) =
\frac{1}{\pi} \frac{-\mathrm{Im}(\Sigma)}{\left( E -
    \varepsilon_{\mathbf{k}} + \mu - \mathrm{Re}(\Sigma) \right)^2 + (\mathrm{Im}(\Sigma))^2}.
\end{equation}
%
Here, $\Sigma$ marks RPA self-energy.

\bibliography{library}

\end{document}
